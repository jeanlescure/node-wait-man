!function t(e,n,i){function o(s,u){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(r)return r(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var f=n[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return o(n?n:t)},f,f.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){!function(){function t(t){function e(t,e){for(k in e)t[k]=e[k]}function n(){throw"No done callback found!"}this.extend=e,this.WaiterCollection=function(t){function i(t){var e=a.pending_waiters.filter(function(e){return e.uid===t})[0];a.successful_waiters.push(e),o(t)}function o(t){a.pending_waiters=a.pending_waiters.filter(function(e){return e.uid!==t})}function r(){a.check_timeout()&&a.abort(),a.aborted||(a.timeoutfn=setTimeout(function(){a.check_timeout()&&a.abort(),0!==a.pending_waiters.length||a.aborted?r():a.onDone()},a.interval))}function s(){a.pending_waiters=a.waiters.filter(function(){return!0}),a.successful_waiters=[],a.aborted_waiters=[]}function u(){"undefined"!=typeof a.timeoutfn&&clearTimeout(a.timeoutfn)}var a=this;this.defaults={waiters:[],pending_waiters:[],successful_waiters:[],aborted_waiters:[],onDone:n,interval:100,timeout:0,beganAt:0,endedAt:0,aborted:!1},this.options=t,e(this,this.defaults),"undefined"!=typeof this.options&&e(this,this.options),this.elapsed=function(){var t=this.pending_waiters.length>0?+new Date-this.beganAt:this.endedAt-this.beganAt;return t},this.check_timeout=function(){return this.elapsed()>this.timeout&&this.timeout>0},this.begin=function(){if(a.waiters.length<1)throw"No waiters set!";a.beganAt=+new Date,a.endedAt=0,s(),a.aborted=!1;for(var t in a.pending_waiters)a.pending_waiters[t].begin(i);r()},this.abort=function(){if(a.pending_waiters.length>0){u(),a.aborted=!0;for(var t in a.pending_waiters)a.pending_waiters[0].abort(),a.aborted_waiters.push(a.pending_waiters[0]),o(a.pending_waiters[0].uid);a.endedAt=+new Date,a.onDone()}}},this.Waiter=function(t){function n(){"undefined"!=typeof i.timeoutfn&&clearTimeout(i.timeoutfn)}var i=this;this.defaults={test:function(){throw"No test function for waiter defined!"},interval:100,timeout:0,beganAt:0,endedAt:0,pending:!1,successful:!1,aborted:!1},this.options=t,e(this,this.defaults),"undefined"!=typeof this.options&&e(this,this.options),this.elapsed=function(){var t=this.pending?+new Date-this.beganAt:this.endedAt-this.beganAt;return t},this.check_timeout=function(){return this.elapsed()>this.timeout&&this.timeout>0},this.uid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)}),this.tick=function(t){if(n(),"undefined"==typeof t)throw"No success callback function defined for waiter!";i.check_timeout()&&i.abort(),i.aborted||(i.timeoutfn=setTimeout(function(){i.check_timeout()&&i.abort(),i.test()&&!i.aborted?(i.pending=!1,i.successful=!0,i.endedAt=+new Date,t(i.uid)):i.aborted||i.tick(t)},i.interval))},this.begin=function(t){n(),i.pending=!0,i.successful=!1,i.aborted=!1,i.beganAt=+new Date,i.endedAt=0,i.tick(t)},this.abort=function(){i.pending&&(n(),i.pending=!1,i.aborted=!0,i.endedAt=+new Date)}}}"undefined"!=typeof e&&"undefined"!=typeof e.exports?e.exports=t:"function"==typeof define&&define.amd?define([],function(){return t}):window.WaitMan=t}()},{}]},{},[1]);
//# sourceMappingURL=wait-man.js.map